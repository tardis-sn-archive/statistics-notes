(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     41013,       1376]
NotebookOptionsPosition[     38230,       1275]
NotebookOutlinePosition[     38596,       1291]
CellTagsIndexPosition[     38553,       1288]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Integrals of moments of the beta distribution with improper uniform prior for \
parameters a,b
Version: HC Eggers, 11 December 2015
See formulae in the Bayes TARDIS prediction paper\
\>", "Section"],

Cell["\<\
One small attempt to see what happens if you limit the uniform priors to be \
proper, with maxima U and V. This has no relevance for the rest of the \
notebook.\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{
    RowBox[{"U", ">", "1"}], " ", "&&", " ", 
    RowBox[{"U", "\[Element]", " ", "Integers"}], " ", "&&", " ", 
    RowBox[{"V", ">", "1"}], " ", "&&", " ", 
    RowBox[{"V", "\[Element]", " ", "Integers"}], " ", "&&", " ", 
    RowBox[{"y", " ", ">", " ", "0"}], " ", "&&", " ", 
    RowBox[{"y", " ", "<", " ", "1"}], " ", "&&", " ", 
    RowBox[{"z", " ", ">", " ", "0"}], " ", "&&", " ", 
    RowBox[{"z", " ", "<", " ", "1"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Sum", "[", 
  RowBox[{
   SuperscriptBox["y", 
    RowBox[{"u", "-", "1"}]], ",", 
   RowBox[{"{", 
    RowBox[{"u", ",", "1", ",", "U"}], "}"}]}], "]"}]}], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "1"}], "+", 
   SuperscriptBox["y", "U"]}], 
  RowBox[{
   RowBox[{"-", "1"}], "+", "y"}]]], "Output"]
}, Open  ]],

Cell["Phi-moments for improper uniform prior", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ephi0", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Sum", "[", 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox["y", 
        RowBox[{"u", "-", "1"}]], "*", 
       SuperscriptBox["z", 
        RowBox[{"v", "-", "1"}]]}], 
      RowBox[{"Beta", "[", 
       RowBox[{"u", ",", "v"}], "]"}]], ",", 
     RowBox[{"{", 
      RowBox[{"u", ",", "1", ",", "Infinity"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v", ",", "1", ",", "Infinity"}], "}"}]}], "]"}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 FractionBox["1", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "y", "+", "z"}], ")"}], "2"]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ephi1", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      FractionBox["u", 
       RowBox[{"u", "+", "v"}]], "*", 
      FractionBox[
       RowBox[{
        SuperscriptBox["y", 
         RowBox[{"u", "-", "1"}]], "*", 
        SuperscriptBox["z", 
         RowBox[{"v", "-", "1"}]]}], 
       RowBox[{"Beta", "[", 
        RowBox[{"u", ",", "v"}], "]"}]]}], ",", 
     RowBox[{"{", 
      RowBox[{"u", ",", "1", ",", "Infinity"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v", ",", "1", ",", "Infinity"}], "}"}]}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "TraditionalForm"}]}], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"y", "+", "z"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["y", "2"]}], "+", 
       RowBox[{"y", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "z"}], ")"}]}], "+", "z", "-", 
       SuperscriptBox["z", "2"]}], ")"}]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "y", "+", "z"}], ")"}], "2"]], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "y"}], "+", "z"}], ")"}], " ", 
    RowBox[{"Log", "[", 
     RowBox[{"1", "-", "y", "-", "z"}], "]"}]}]}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"y", "+", "z"}], ")"}], "3"]]], "Output"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"y", "+", "z"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["y", "2"]}], "+", 
        RowBox[{"y", " ", 
         RowBox[{"(", 
          RowBox[{"z", "-", "1"}], ")"}]}], "-", 
        SuperscriptBox["z", "2"], "+", "z"}], ")"}]}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"y", "+", "z", "-", "1"}], ")"}], "2"]], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"z", "-", "y"}], ")"}], " ", 
     RowBox[{"log", "(", 
      RowBox[{
       RowBox[{"-", "y"}], "-", "z", "+", "1"}], ")"}]}]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"y", "+", "z"}], ")"}], "3"]], TraditionalForm]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"ephi1", "/", "ephi0"}], "]"}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"y", "+", "z"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       SuperscriptBox["y", "2"]}], "+", 
      RowBox[{"y", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "z"}], ")"}]}], "+", "z", "-", 
      SuperscriptBox["z", "2"]}], ")"}]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"y", "-", "z"}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "y", "+", "z"}], ")"}], "2"], " ", 
    RowBox[{"Log", "[", 
     RowBox[{"1", "-", "y", "-", "z"}], "]"}]}]}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"y", "+", "z"}], ")"}], "3"]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ephi2", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"u", "*", 
         RowBox[{"(", 
          RowBox[{"u", "+", "1"}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"u", "+", "v"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"u", "+", "v", "+", "1"}], ")"}]}]], "*", 
       FractionBox[
        RowBox[{
         SuperscriptBox["y", 
          RowBox[{"u", "-", "1"}]], "*", 
         SuperscriptBox["z", 
          RowBox[{"v", "-", "1"}]]}], 
        RowBox[{"Beta", "[", 
         RowBox[{"u", ",", "v"}], "]"}]]}], ",", 
      RowBox[{"{", 
       RowBox[{"u", ",", "1", ",", "Infinity"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v", ",", "1", ",", "Infinity"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "TraditionalForm"}]}], "Input"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   RowBox[{
    FractionBox["1", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y", "+", "z", "-", "1"}], ")"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y", "+", "z"}], ")"}], "5"]}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["y", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"z", "+", "1"}], ")"}]}], "+", 
         RowBox[{"y", " ", 
          RowBox[{"(", 
           RowBox[{"z", "-", "8"}], ")"}], " ", "z"}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"z", "-", "2"}], ")"}], " ", 
          SuperscriptBox["z", "2"]}]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"y", "+", "z", "-", "1"}], ")"}], "2"], " ", 
       RowBox[{"log", "(", 
        RowBox[{
         RowBox[{"-", "y"}], "-", "z", "+", "1"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"y", "+", "z"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["y", "4"], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["y", "3"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"5", " ", "z"}], "+", "3"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["y", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"22", "-", 
               RowBox[{"19", " ", "z"}]}], ")"}], " ", "z"}], "+", "4"}], 
           ")"}]}], "-", 
         RowBox[{"4", " ", "y", " ", 
          RowBox[{"(", 
           RowBox[{"z", "-", "4"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"z", "-", "1"}], ")"}], " ", "z"}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"z", "-", "1"}], ")"}], "2"], " ", 
          SuperscriptBox["z", "2"]}]}], ")"}]}]}], ")"}]}]}], 
  TraditionalForm]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"Expand", "[", 
    RowBox[{"ephi2", "*", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "y", "+", "z"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"y", "+", "z"}], ")"}], "5"]}], "]"}], ",", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "-", "y", "-", "z"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "4"}], " ", 
   SuperscriptBox["y", "3"]}], "+", 
  RowBox[{"6", " ", 
   SuperscriptBox["y", "4"]}], "-", 
  SuperscriptBox["y", "5"], "+", 
  RowBox[{"12", " ", 
   SuperscriptBox["y", "2"], " ", "z"}], "-", 
  RowBox[{"16", " ", 
   SuperscriptBox["y", "3"], " ", "z"}], "+", 
  RowBox[{"9", " ", 
   SuperscriptBox["y", "4"], " ", "z"}], "+", 
  RowBox[{"12", " ", "y", " ", 
   SuperscriptBox["z", "2"]}], "-", 
  RowBox[{"42", " ", 
   SuperscriptBox["y", "2"], " ", 
   SuperscriptBox["z", "2"]}], "+", 
  RowBox[{"29", " ", 
   SuperscriptBox["y", "3"], " ", 
   SuperscriptBox["z", "2"]}], "-", 
  RowBox[{"4", " ", 
   SuperscriptBox["z", "3"]}], "-", 
  RowBox[{"12", " ", "y", " ", 
   SuperscriptBox["z", "3"]}], "+", 
  RowBox[{"23", " ", 
   SuperscriptBox["y", "2"], " ", 
   SuperscriptBox["z", "3"]}], "+", 
  RowBox[{"8", " ", 
   SuperscriptBox["z", "4"]}], "-", 
  RowBox[{"4", " ", 
   SuperscriptBox["z", "5"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "4"}], " ", 
      SuperscriptBox["y", "2"]}], "+", 
     RowBox[{"8", " ", 
      SuperscriptBox["y", "3"]}], "-", 
     RowBox[{"4", " ", 
      SuperscriptBox["y", "4"]}], "+", 
     RowBox[{"16", " ", "y", " ", "z"}], "-", 
     RowBox[{"28", " ", 
      SuperscriptBox["y", "2"], " ", "z"}], "+", 
     RowBox[{"16", " ", 
      SuperscriptBox["y", "3"], " ", "z"}], "-", 
     RowBox[{"4", " ", 
      SuperscriptBox["y", "4"], " ", "z"}], "-", 
     RowBox[{"4", " ", 
      SuperscriptBox["z", "2"]}], "-", 
     RowBox[{"26", " ", "y", " ", 
      SuperscriptBox["z", "2"]}], "+", 
     RowBox[{"36", " ", 
      SuperscriptBox["y", "2"], " ", 
      SuperscriptBox["z", "2"]}], "-", 
     RowBox[{"10", " ", 
      SuperscriptBox["y", "3"], " ", 
      SuperscriptBox["z", "2"]}], "+", 
     RowBox[{"10", " ", 
      SuperscriptBox["z", "3"]}], "+", 
     RowBox[{"8", " ", "y", " ", 
      SuperscriptBox["z", "3"]}], "-", 
     RowBox[{"6", " ", 
      SuperscriptBox["y", "2"], " ", 
      SuperscriptBox["z", "3"]}], "-", 
     RowBox[{"8", " ", 
      SuperscriptBox["z", "4"]}], "+", 
     RowBox[{"2", " ", "y", " ", 
      SuperscriptBox["z", "4"]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["z", "5"]}]}], ")"}], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "-", "y", "-", "z"}], "]"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ephi11", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["u", 
         RowBox[{"u", "+", "v"}]], ")"}], "2"], "*", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", "y"}], ")"}], 
       RowBox[{"u", "-", "1"}]], "*", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", "z"}], ")"}], 
       RowBox[{"v", "-", "1"}]]}], ",", 
     RowBox[{"{", 
      RowBox[{"u", ",", "1", ",", "Infinity"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v", ",", "1", ",", "Infinity"}], "}"}]}], "]"}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"y", "-", "z"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "y"}], "+", "z", "+", 
      RowBox[{"2", " ", "y", " ", 
       RowBox[{"Log", "[", "y", "]"}]}]}], ")"}]}], "+", 
   RowBox[{"y", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "y", "+", "z"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PolyLog", "[", 
       RowBox[{"2", ",", 
        RowBox[{"1", "-", "y"}]}], "]"}], "-", 
      RowBox[{"PolyLog", "[", 
       RowBox[{"2", ",", 
        RowBox[{"1", "-", "z"}]}], "]"}]}], ")"}]}]}], 
  RowBox[{"y", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"y", "-", "z"}], ")"}], "3"]}]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "TraditionalForm"}]], "Input"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"y", " ", 
     RowBox[{"(", 
      RowBox[{"y", "+", "z", "-", "2"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       TemplateBox[{"2",RowBox[{"1", "-", "y"}]},
        "PolyLog"], "-", 
       TemplateBox[{"2",RowBox[{"1", "-", "z"}]},
        "PolyLog"]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"y", "-", "z"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "y"}], "+", 
       RowBox[{"2", " ", "y", " ", 
        RowBox[{"log", "(", "y", ")"}]}], "+", "z"}], ")"}]}]}], 
   RowBox[{"y", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"y", "-", "z"}], ")"}], "3"]}]], TraditionalForm]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"**", " ", "This"}], " ", "is", " ", "the", " ", "first", " ", 
     "term", " ", "in", " ", "the", " ", "variance"}], ",", " ", 
    RowBox[{"coefficient", " ", "of", " ", "n", " ", "squared"}]}], " ", 
   "***)"}], "\[IndentingNewLine]", 
  RowBox[{"term1", "=", 
   RowBox[{"FullSimplify", "[", 
    FractionBox[
     RowBox[{
      RowBox[{"ephi11", "*", "ephi0"}], " ", "-", " ", 
      RowBox[{"ephi1", "*", "ephi1"}]}], 
     RowBox[{"ephi0", "*", "ephi0"}]], "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "y", "+", "z"}], ")"}], "4"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"y", "+", "z"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["y", "2"]}], "+", 
             RowBox[{"y", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "z"}], ")"}]}], "+", "z", "-", 
             SuperscriptBox["z", "2"]}], ")"}]}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "y", "+", "z"}], ")"}], "2"]], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "y"}], "+", "z"}], ")"}], " ", 
          RowBox[{"Log", "[", 
           RowBox[{"1", "-", "y", "-", "z"}], "]"}]}]}], ")"}], "2"], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y", "+", "z"}], ")"}], "6"]]}], "+", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"y", "-", "z"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "y"}], "+", "z", "+", 
         RowBox[{"2", " ", "y", " ", 
          RowBox[{"Log", "[", "y", "]"}]}]}], ")"}]}], "+", 
      RowBox[{"y", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "y", "+", "z"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"PolyLog", "[", 
          RowBox[{"2", ",", 
           RowBox[{"1", "-", "y"}]}], "]"}], "-", 
         RowBox[{"PolyLog", "[", 
          RowBox[{"2", ",", 
           RowBox[{"1", "-", "z"}]}], "]"}]}], ")"}]}]}], 
     RowBox[{"y", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y", "-", "z"}], ")"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "y", "+", "z"}], ")"}], "2"]}]]}], 
   ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"**", " ", "This"}], " ", "is", " ", "the", " ", "second", " ", 
     "term", " ", "in", " ", "the", " ", "variance"}], ",", " ", 
    RowBox[{"coefficient", " ", "of", " ", "n"}]}], " ", "***)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"term2", "=", 
   RowBox[{"FullSimplify", "[", 
    FractionBox["ephi2", "ephi0"], "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"y", "+", "z"}], ")"}], "5"]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"y", "+", "z"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["y", "4"], "-", 
        RowBox[{"4", " ", "y", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "4"}], "+", "z"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", "z"}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "z"}], ")"}], "2"], " ", 
         SuperscriptBox["z", "2"]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["y", "3"], " ", 
         RowBox[{"(", 
          RowBox[{"3", "+", 
           RowBox[{"5", " ", "z"}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["y", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"4", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"22", "-", 
              RowBox[{"19", " ", "z"}]}], ")"}], " ", "z"}]}], ")"}]}]}], 
       ")"}]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "y", "+", "z"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"y", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "8"}], "+", "z"}], ")"}], " ", "z"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "z"}], ")"}], " ", 
         SuperscriptBox["z", "2"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["y", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "z"}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Log", "[", 
       RowBox[{"1", "-", "y", "-", "z"}], "]"}]}]}], ")"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"variance", " ", "=", " ", 
  RowBox[{
   RowBox[{
    SuperscriptBox["n", "2"], "*", "term1"}], " ", "+", " ", 
   RowBox[{"n", "*", "term2"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{
    FractionBox["1", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"y", "+", "z"}], ")"}], "5"]], 
    RowBox[{"n", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"y", "+", "z"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["y", "4"], "-", 
          RowBox[{"4", " ", "y", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "4"}], "+", "z"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", "z"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "z"}], ")"}], "2"], " ", 
           SuperscriptBox["z", "2"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["y", "3"], " ", 
           RowBox[{"(", 
            RowBox[{"3", "+", 
             RowBox[{"5", " ", "z"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["y", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"4", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"22", "-", 
                RowBox[{"19", " ", "z"}]}], ")"}], " ", "z"}]}], ")"}]}]}], 
         ")"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "y", "+", "z"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"y", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "8"}], "+", "z"}], ")"}], " ", "z"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "z"}], ")"}], " ", 
           SuperscriptBox["z", "2"]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["y", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "z"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "-", "y", "-", "z"}], "]"}]}]}], ")"}]}]}]}], "+", 
  RowBox[{
   SuperscriptBox["n", "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "y", "+", "z"}], ")"}], "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"y", "+", "z"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", 
               SuperscriptBox["y", "2"]}], "+", 
              RowBox[{"y", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "z"}], ")"}]}], "+", "z", "-", 
              SuperscriptBox["z", "2"]}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "y", "+", "z"}], ")"}], "2"]], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "y"}], "+", "z"}], ")"}], " ", 
           RowBox[{"Log", "[", 
            RowBox[{"1", "-", "y", "-", "z"}], "]"}]}]}], ")"}], "2"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"y", "+", "z"}], ")"}], "6"]]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"y", "-", "z"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y"}], "+", "z", "+", 
          RowBox[{"2", " ", "y", " ", 
           RowBox[{"Log", "[", "y", "]"}]}]}], ")"}]}], "+", 
       RowBox[{"y", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "y", "+", "z"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"PolyLog", "[", 
           RowBox[{"2", ",", 
            RowBox[{"1", "-", "y"}]}], "]"}], "-", 
          RowBox[{"PolyLog", "[", 
           RowBox[{"2", ",", 
            RowBox[{"1", "-", "z"}]}], "]"}]}], ")"}]}]}], 
      RowBox[{"y", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"y", "-", "z"}], ")"}], "3"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "y", "+", "z"}], ")"}], "2"]}]]}], 
    ")"}]}]}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Fred: Check negative binomial for posterior predictive of N|n\
\>", "Title",
 CellChangeTimes->{{3.661675572644771*^9, 3.6616755963725557`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{"-", "\[Lambda]"}], "]"}], 
    FractionBox[
     SuperscriptBox["\[Lambda]", 
      RowBox[{"n", "-", "a"}]], 
     RowBox[{"n", "!"}]]}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", ",", "0", ",", "\[Infinity]"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.661675616940963*^9, 3.6616756945970907`*^9}}],

Cell[BoxData[
 RowBox[{"ConditionalExpression", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"Gamma", "[", 
     RowBox[{"1", "-", "a", "+", "n"}], "]"}], 
    RowBox[{"n", "!"}]], ",", 
   RowBox[{
    RowBox[{"Re", "[", 
     RowBox[{"a", "-", "n"}], "]"}], "<", "1"}]}], "]"}]], "Output",
 CellChangeTimes->{3.66167569900933*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{"-", "\[Lambda]"}], "]"}], 
    FractionBox[
     SuperscriptBox["\[Lambda]", "k"], 
     RowBox[{"k", "!"}]], 
    RowBox[{"Exp", "[", 
     RowBox[{"-", "\[Lambda]"}], "]"}], 
    FractionBox[
     SuperscriptBox["\[Lambda]", 
      RowBox[{"n", "-", "a"}]], 
     RowBox[{"n", "!"}]]}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", ",", "0", ",", "\[Infinity]"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.661675892108343*^9, 3.661675971948864*^9}}],

Cell[BoxData[
 RowBox[{"ConditionalExpression", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["2", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "a", "-", "k", "-", "n"}]], " ", 
     RowBox[{"Gamma", "[", 
      RowBox[{"1", "-", "a", "+", "k", "+", "n"}], "]"}]}], 
    RowBox[{
     RowBox[{"k", "!"}], " ", 
     RowBox[{"n", "!"}]}]], ",", 
   RowBox[{
    RowBox[{"Re", "[", 
     RowBox[{"a", "-", "k", "-", "n"}], "]"}], "<", "1"}]}], "]"}]], "Output",\

 CellChangeTimes->{3.66167597432621*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Fred: Check raw moments of negative binomial. Mgf from wikipedia, so no sign \
needed in derivatives\
\>", "Title",
 CellChangeTimes->{{3.6616873723781233`*^9, 3.6616873839804087`*^9}, {
  3.6616883124133368`*^9, 3.661688348244912*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox[
           RowBox[{"1", "-", "p"}], 
           RowBox[{"1", "-", 
            RowBox[{"p", " ", 
             RowBox[{"Exp", "[", "t", "]"}]}]}]], ")"}], "r"], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "s"}], "}"}]}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"t", "\[Rule]", "0"}], ",", 
        RowBox[{"p", "\[Rule]", 
         RowBox[{"1", "/", "2"}]}], ",", 
        RowBox[{"r", "\[Rule]", 
         RowBox[{"n", "+", "1", "-", "a"}]}]}], "}"}]}], "//", "Factor"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"s", ",", "2"}], "}"}]}], "]"}], 
  RowBox[{"(*", 
   RowBox[{"mgn", ",", " ", "mgp"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.661687880412796*^9, 3.661687956305957*^9}, {
  3.6616879864813557`*^9, 3.661688005562207*^9}, {3.661688038684268*^9, 
  3.6616880472662363`*^9}, {3.661688131088108*^9, 3.661688174725956*^9}, {
  3.661688207406311*^9, 3.6616882090594587`*^9}, {3.6616915622865543`*^9, 
  3.661691624442258*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1", "-", "a", "+", "n"}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "3"}], "+", "a", "-", "n"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "a", "-", "n"}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6616879296234417`*^9, 3.66168800712817*^9, {3.661688041114205*^9, 
   3.661688048557992*^9}, {3.66168814869143*^9, 3.6616881793864202`*^9}, 
   3.66168821010546*^9, 3.66169158343361*^9, 3.6616916255432587`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fred: check variance of L", "Title",
 CellChangeTimes->{{3.6616911886040154`*^9, 3.6616911975246553`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ex1", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"n", "-", "a", "+", "1"}], ")"}], 
    FractionBox[
     RowBox[{"Ex", "[", 
      SubscriptBox["\[Mu]", "1"], "]"}], 
     RowBox[{"Ex", "[", "1", "]"}]]}]}], 
  RowBox[{"(*", 
   RowBox[{"mgo", ",", " ", 
    RowBox[{"1", "st", " ", "moment"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ex2", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"(", 
      RowBox[{"n", "-", "a", "+", "1"}], ")"}], 
     RowBox[{"Ex", "[", "1", "]"}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "a", "+", "2"}], ")"}], 
       RowBox[{"Ex", "[", 
        SuperscriptBox[
         SubscriptBox["\[Mu]", "1"], "2"], "]"}]}], "+", 
      RowBox[{"Ex", "[", 
       SubscriptBox["\[Mu]", "2"], "]"}]}], ")"}]}]}], 
  RowBox[{"(*", 
   RowBox[{"mgq", ",", " ", 
    RowBox[{"2", "nd", " ", "moment"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"var", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"ex2", "-", 
     SuperscriptBox["ex1", "2"]}], "//", "Simplify"}], "//", 
   "TraditionalForm", 
   RowBox[{"(*", 
    RowBox[{"mgr", ",", " ", "variance"}], "*)"}]}]}]}], "Input",
 CellChangeTimes->{{3.6616912293678427`*^9, 3.661691353871714*^9}, {
  3.661691460063386*^9, 3.6616915300616703`*^9}, {3.661691716100657*^9, 
  3.661691727517116*^9}, {3.662445995755836*^9, 3.662445999135903*^9}, {
  3.662446417279729*^9, 3.662446417386819*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", "a", "+", "n"}], ")"}], " ", 
   RowBox[{"Ex", "[", 
    SubscriptBox["\[Mu]", "1"], "]"}]}], 
  RowBox[{"Ex", "[", "1", "]"}]]], "Output",
 CellChangeTimes->{{3.6616913468381233`*^9, 3.661691356596961*^9}, 
   3.6624460026173973`*^9, 3.6624464196196613`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", "a", "+", "n"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", "-", "a", "+", "n"}], ")"}], " ", 
      RowBox[{"Ex", "[", 
       SubsuperscriptBox["\[Mu]", "1", "2"], "]"}]}], "+", 
     RowBox[{"Ex", "[", 
      SubscriptBox["\[Mu]", "2"], "]"}]}], ")"}]}], 
  RowBox[{"Ex", "[", "1", "]"}]]], "Output",
 CellChangeTimes->{{3.6616913468381233`*^9, 3.661691356596961*^9}, 
   3.6624460026173973`*^9, 3.662446419621007*^9}],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"a", "-", "n", "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "a"}], "+", "n", "+", "1"}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"Ex", "(", 
         SubscriptBox["\[Mu]", "1"], ")"}], "2"]}], "+", 
      RowBox[{
       RowBox[{"Ex", "(", "1", ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a", "-", "n", "-", "2"}], ")"}], " ", 
          RowBox[{"Ex", "(", 
           SubsuperscriptBox["\[Mu]", "1", "2"], ")"}]}], "-", 
         RowBox[{"Ex", "(", 
          SubscriptBox["\[Mu]", "2"], ")"}]}], ")"}]}]}], ")"}]}], 
   SuperscriptBox[
    RowBox[{"Ex", "(", "1", ")"}], "2"]], TraditionalForm]], "Output",
 CellChangeTimes->{{3.6616913468381233`*^9, 3.661691356596961*^9}, 
   3.6624460026173973`*^9, 3.662446419649452*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fred: conjugate prior of Beta distribution. ", "Title",
 CellChangeTimes->{{3.661695878420874*^9, 3.661695887508601*^9}, {
  3.661701653430406*^9, 3.6617016587106867`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"prior", "[", 
    RowBox[{"a_", ",", "b_", ",", "x0_", ",", "y0_", ",", "\[Lambda]_"}], 
    "]"}], ":=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"Beta", "[", 
      RowBox[{"a", ",", "b"}], "]"}], 
     RowBox[{"-", "\[Lambda]"}]], 
    SuperscriptBox["x0", 
     RowBox[{"a", "-", "1"}]], " ", 
    SuperscriptBox["y0", 
     RowBox[{"b", "-", "1"}]]}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"prior", "[", 
     RowBox[{"a_", ",", "b_", ",", "x0_", ",", "y0_", ",", "\[Lambda]_"}], 
     "]"}], ":=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Beta", "[", 
       RowBox[{"a", ",", "b"}], "]"}], 
      RowBox[{"-", "\[Lambda]"}]], 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "x0"}], " ", "a"}], "-", 
       RowBox[{"y0", " ", "b"}]}], "]"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"PDF", "[", 
  RowBox[{
   RowBox[{"BetaDistribution", "[", 
    RowBox[{"a", ",", "b"}], "]"}], ",", "x"}], "]"}], "\[IndentingNewLine]", 

 RowBox[{" ", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", "x"}], ")"}], 
       RowBox[{
        RowBox[{"-", "1"}], "+", "b"}]], " ", 
      SuperscriptBox["x", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "a"}]]}], 
     RowBox[{"Beta", "[", 
      RowBox[{"a", ",", "b"}], "]"}]], " ", 
    RowBox[{"prior", "[", 
     RowBox[{"a", ",", "b", ",", "1", ",", "1", ",", "0"}], "]"}]}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.661693953070692*^9, 3.661693957919548*^9}, {
  3.661695894314527*^9, 3.661696037040765*^9}, {3.661696171656542*^9, 
  3.661696174815312*^9}, {3.6616972712782784`*^9, 3.661697333704686*^9}, {
  3.661698111442177*^9, 3.661698159768681*^9}, {3.661701429422072*^9, 
  3.661701504154511*^9}, {3.661701542992567*^9, 3.661701627365419*^9}, {
  3.661701662200094*^9, 3.661701696319071*^9}}],

Cell[BoxData[
 StyleBox[
  RowBox[{"mathematica", " ", 
   RowBox[{"doesn", "'"}], "t", "  ", "know", " ", "the", " ", 
   "normalization"}], "Text"]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Assuming", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"x", ">", "0"}], "&&", 
    RowBox[{"x", "<", "1"}]}], ",", 
   RowBox[{"Integrate", "[", 
    RowBox[{"%", ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "0", ",", "\[Infinity]"}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.661693953070692*^9, 3.661693957919548*^9}, {
  3.661695894314527*^9, 3.661696037040765*^9}, {3.661696171656542*^9, 
  3.661696174815312*^9}, {3.6616972712782784`*^9, 3.661697333704686*^9}, {
  3.661698111442177*^9, 3.661698159768681*^9}, {3.661701429422072*^9, 
  3.661701504154511*^9}, {3.661701542992567*^9, 3.661701627365419*^9}, {
  3.661701662200094*^9, 3.661701696319071*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        FractionBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "x"}], ")"}], 
           RowBox[{
            RowBox[{"-", "1"}], "+", "b"}]], " ", 
          SuperscriptBox["x", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "a"}]]}], 
         RowBox[{"Beta", "[", 
          RowBox[{"a", ",", "b"}], "]"}]], 
        RowBox[{"0", "<", "x", "<", "1"}]},
       {"0", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}},
      Selectable->True]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxItemSize->{
    "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{
  3.661695906133119*^9, 3.661695995468672*^9, {3.661696029551408*^9, 
   3.661696037742318*^9}, 3.661696177158492*^9, 3.6616981609631557`*^9, {
   3.661701433802731*^9, 3.6617014500005083`*^9}, {3.6617014936660233`*^9, 
   3.661701504938327*^9}, {3.661701543863199*^9, 3.661701628094481*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", "x"}], ")"}], 
    RowBox[{
     RowBox[{"-", "1"}], "+", "b"}]], " ", 
   SuperscriptBox["x", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "a"}]]}], 
  RowBox[{"Beta", "[", 
   RowBox[{"a", ",", "b"}], "]"}]]], "Output",
 CellChangeTimes->{
  3.661695906133119*^9, 3.661695995468672*^9, {3.661696029551408*^9, 
   3.661696037742318*^9}, 3.661696177158492*^9, 3.6616981609631557`*^9, {
   3.661701433802731*^9, 3.6617014500005083`*^9}, {3.6617014936660233`*^9, 
   3.661701504938327*^9}, {3.661701543863199*^9, 3.6617016280957413`*^9}}],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["\[Integral]", "0", "\[Infinity]"], 
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "x"}], ")"}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", "b"}]], " ", 
     SuperscriptBox["x", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "a"}]]}], 
    RowBox[{"Beta", "[", 
     RowBox[{"a", ",", "b"}], "]"}]], 
   RowBox[{"\[DifferentialD]", "a"}]}]}]], "Output",
 CellChangeTimes->{
  3.661695906133119*^9, 3.661695995468672*^9, {3.661696029551408*^9, 
   3.661696037742318*^9}, 3.661696177158492*^9, 3.6616981609631557`*^9, {
   3.661701433802731*^9, 3.6617014500005083`*^9}, {3.6617014936660233`*^9, 
   3.661701504938327*^9}, {3.661701543863199*^9, 3.661701633279669*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{928, 1053},
WindowMargins->{{929, Automatic}, {0, Automatic}},
Magnification:>1.5 Inherited,
FrontEndVersion->"10.1 for Linux x86 (64-bit) (March 23, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 208, 5, 361, "Section"],
Cell[791, 29, 184, 4, 102, "Text"],
Cell[CellGroupData[{
Cell[1000, 37, 712, 17, 111, "Input"],
Cell[1715, 56, 157, 6, 78, "Output"]
}, Open  ]],
Cell[1887, 65, 54, 0, 45, "Text"],
Cell[CellGroupData[{
Cell[1966, 69, 532, 17, 173, "Input"],
Cell[2501, 88, 152, 5, 78, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2690, 98, 686, 21, 204, "Input"],
Cell[3379, 121, 794, 28, 106, "Output"],
Cell[4176, 151, 799, 27, 119, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5012, 183, 96, 2, 45, "Input"],
Cell[5111, 187, 748, 26, 111, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5896, 218, 943, 29, 171, "Input"],
Cell[6842, 249, 2052, 64, 196, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8931, 318, 420, 13, 53, "Input"],
Cell[9354, 333, 2400, 74, 162, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11791, 412, 678, 22, 158, "Input"],
Cell[12472, 436, 758, 26, 111, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13267, 467, 64, 1, 45, "Input"],
Cell[13334, 470, 725, 24, 91, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14096, 499, 566, 15, 144, "Input"],
Cell[14665, 516, 2145, 69, 332, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16847, 590, 417, 11, 144, "Input"],
Cell[17267, 603, 1973, 63, 140, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19277, 671, 181, 5, 47, "Input"],
Cell[19461, 678, 4361, 135, 494, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[23871, 819, 154, 3, 309, "Title"],
Cell[CellGroupData[{
Cell[24050, 826, 419, 13, 82, "Input"],
Cell[24472, 841, 332, 10, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24841, 856, 567, 18, 85, "Input"],
Cell[25411, 876, 525, 17, 127, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[25985, 899, 246, 5, 394, "Title"],
Cell[CellGroupData[{
Cell[26256, 908, 1174, 33, 218, "Input"],
Cell[27433, 943, 532, 14, 45, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[28014, 963, 112, 1, 139, "Title"],
Cell[CellGroupData[{
Cell[28151, 968, 1475, 44, 255, "Input"],
Cell[29629, 1014, 337, 9, 77, "Output"],
Cell[29969, 1025, 553, 16, 81, "Output"],
Cell[30525, 1043, 976, 29, 171, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[31550, 1078, 178, 2, 224, "Title"],
Cell[31731, 1082, 1971, 58, 185, "Input"],
Cell[33705, 1142, 160, 4, 46, "Input"],
Cell[CellGroupData[{
Cell[33890, 1150, 702, 16, 45, "Input"],
Cell[34595, 1168, 2190, 61, 90, "Output"],
Cell[36788, 1231, 634, 17, 80, "Output"],
Cell[37425, 1250, 777, 21, 80, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
